/**
 * List Record Management
 *
 * @copyright: Copyright (C) 2025, Jlowcode Organization - All rights reserved.
 * @license  : GNU/GPL http  //www.gnu.org/copyleft/gpl.html
 */
define(["jquery","fab/fabrik","fab/list-plugin"],(function(t,e,o){return new Class({Extends:o,Implements:[Events],options:{},initialize:function(t){this.options=JSON.parse(t),!1!==this.options.canUse&&this.setButtons()},setButtons:function(){var o=this;t(".middle-buttons").prepend(t("<li>").append(t("<a>",{id:"check-deadlines",text:Joomla.JText._("PLG_FABRIK_LIST_RECORDS_MANAGEMENT_CHECK_DEADLINES")}).css("cursor","pointer").on("click",(function(n){e.loader.start(t(".listContent"),Joomla.JText._("COM_FABRIK_LOADING")),n.preventDefault(),o.requestCheckDeadlines()}))))},requestCheckDeadlines:function(){var o=this,n={option:"com_fabrik",format:"raw",task:"plugin.pluginAjax",plugin:"records_management",method:"checkDeadlines",g:"list",listid:this.options.listId};t.ajax({url:"",method:"post",data:n}).done((function(o){if((o=JSON.parse(o)).error)return alert(Joomla.JText._("PLG_FABRIK_LIST_RECORDS_MANAGEMENT_ERROR")),console.warn(o.message),void location.reload();alert(Joomla.JText._("PLG_FABRIK_LIST_RECORDS_MANAGEMENT_DEADLINES_CHECKED")),e.loader.stop(t(".listContent"))})).fail((function(t,e,a){var s={url:"",data:n,error:a,status:e,jq:t};o.saveLogs(s)}))},saveLogs:function(e){alert(Joomla.JText._("PLG_FABRIK_LIST_RECORDS_MANAGEMENT_ERROR")),t.ajax({url:"",method:"post",data:{message:JSON.stringify(e),option:"com_fabrik",format:"raw",task:"plugin.pluginAjax",g:"list",plugin:"records_management",method:"saveLogs"}}).done((function(t){location.reload()}))}})}));